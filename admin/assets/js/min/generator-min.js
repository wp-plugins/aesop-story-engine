jQuery(document).ready(function($){var e=$("#aesop-generator-wrap");$(".aesop-add-story-component").click(function(t){t.preventDefault(),"undefined"!=typeof window.aiactive?alert("Nesting components within the visual interface is not supported."):"undefined"!=typeof window.ailocked?alert("Please click on the editor and set your cursor location first."):(jQuery("body").toggleClass("modal-open"),jQuery(e).toggleClass("aesop-generator-open"))});var t=function(){var e=$(window).height()-90;$("#aesop-generator-settings-outer").css({height:e}),700>e?$(".aesop-generator-left").addClass("aesop-generator-small-height"):$(".aesop-generator-left").removeClass("aesop-generator-small-height")},a=function(){if(tinyMCE.activeEditor){var t=tinyMCE.activeEditor.dom.select("#aesop-generator-editing");""!=t&&t[0].removeAttribute("id")}$(e).removeClass("aesop-generator-open"),$("body").removeClass("modal-open"),$("body").removeClass("modal-updating")};t(),$(window).resize(function(){t()}),$(document).keyup(function(e){27==e.keyCode&&a()}),$(".aesop-close-modal").click(function(e){e.preventDefault(),a()}),$(".post-type-ai_galleries .insert-media").html('<span class="dashicons dashicons-images-alt2"></span> Add Gallery'),$(".aesop-generator").dropkick({change:function(){var e=$("#aesop-generator-select").find(":selected").val();$("#aesop-generator-settings").html(aesopshortcodes[e])}}),$("#aesop-generator-insert,.aesop-generator").live("click",function(){$(".aesop-generator-empty").hide();var e=$(".aesop-generator").find(":selected").val(),t=$("#aesop-compatibility-mode-prefix").val();if($("#aesop-generator-result").val("["+t+e),$("#aesop-generator-settings .aesop-generator-attr").each(function(){""!==$(this).val()&&$("#aesop-generator-result").val($("#aesop-generator-result").val()+" "+$(this).attr("name")+'="'+$(this).val()+'"')}),$("#aesop-generator-result").val($("#aesop-generator-result").val()+"]"),"false"!=$("#aesop-generator-content").val()&&$("#aesop-generator-result").val($("#aesop-generator-result").val()+$("#aesop-generator-content").val()+"[/"+t+e+"]"),tinyMCE.activeEditor){var n=tinyMCE.activeEditor.dom.select("#aesop-generator-editing");tinyMCE.activeEditor.dom.remove(n)}return window.send_to_editor(jQuery("#aesop-generator-result").val()),a(),!1})});var file_frame;jQuery("#aesop-upload-img").live("click",function(e){return e.preventDefault(),file_frame?void file_frame.open():(file_frame=wp.media.frames.file_frame=wp.media({title:jQuery(this).data("uploader_title"),button:{text:jQuery(this).data("uploader_button_text")},multiple:!1}),file_frame.on("select",function(){attachment=file_frame.state().get("selection").first().toJSON(),jQuery(".aesop-generator-attr-media_upload,#aesop-generator-attr-src, #aesop-generator-attr-hosted").val(attachment.url)}),void file_frame.open())}),function($,e,t){function a(e,t){var a=e.keyCode,r=t.data("dropkick"),l=t.find(".dk_options"),d=t.hasClass("dk_open"),c=t.find(".dk_option_current"),p=l.find("li").first(),u=l.find("li").last(),v,k;switch(a){case f.enter:d?(n(c.find("a"),t),i(t)):s(t),e.preventDefault();break;case f.up:k=c.prev("li"),d?k.length?o(k,t):o(u,t):s(t),e.preventDefault();break;case f.down:d?(v=c.next("li").first(),v.length?o(v,t):o(p,t)):s(t),e.preventDefault()}}function n(e,t,a){var n,o,r;n=e.attr("data-dk-dropdown-value"),o=e.text(),r=t.data("dropkick"),$select=r.$select,$select.val(n),t.find(".dk_label").text(o),a=a||!1,r.settings.change&&!a&&r.settings.change.call($select,n,o)}function o(e,t){t.find(".dk_option_current").removeClass("dk_option_current"),e.addClass("dk_option_current"),r(t,e)}function r(e,t){var a=t.prevAll("li").outerHeight()*t.prevAll("li").length;e.find(".dk_options_inner").animate({scrollTop:a+"px"},0)}function i(e){e.removeClass("dk_open")}function s(e){var t=e.data("dropkick");e.find(".dk_options").css({top:e.find(".dk_toggle").outerHeight()-1}),e.toggleClass("dk_open")}function l(e,t){var a=e,n=[],o;if(a=a.replace("{{ id }}",t.id),a=a.replace("{{ label }}",t.label),a=a.replace("{{ tabindex }}",t.tabindex),t.options&&t.options.length)for(var r=0,i=t.options.length;i>r;r++){var s=$(t.options[r]),l="dk_option_current",c=k;c=c.replace("{{ classvalue }}",s.val()),c=c.replace("{{ value }}",s.val()),c=c.replace("{{ current }}",d(s.val())===t.value?l:""),c=c.replace("{{ text }}",s.text()),n[n.length]=c}return o=$(a),o.find(".dk_options_inner").html(n.join("")),o}function d(e){return $.trim(e).length>0?e:!1}var c=!1;$.browser.msie&&$.browser.version.substr(0,1)<7?c=!0:t.documentElement.className=t.documentElement.className+" dk_fouc";var p={},u=[],f={left:37,up:38,right:39,down:40,enter:13},v=['<div class="dk_container" id="dk_container_{{ id }}" tabindex="{{ tabindex }}">','<a class="dk_toggle">','<span class="dk_label">{{ label }}</span>',"</a>",'<div class="dk_options">','<ul class="dk_options_inner">',"</ul>","</div>","</div>"].join(""),k='<li class="{{ current }} {{ classvalue }}"><a data-dk-dropdown-value="{{ value }}">{{ text }}</a></li>',g={startSpeed:1e3,theme:!1,change:!1},m=!1;p.init=function(e){return e=$.extend({},g,e),this.each(function(){var t=$(this),a=t.find(":selected").first(),n=t.find("option"),o=t.data("dropkick")||{},r=t.attr("id")||t.attr("name"),i=e.width||t.outerWidth(),s=t.attr("tabindex")?t.attr("tabindex"):"",c=!1,p;return o.id?t:(o.settings=e,o.tabindex=s,o.id=r,o.$original=a,o.$select=t,o.value=d(t.val())||d(a.attr("value")),o.label=a.text(),o.options=n,c=l(v,o),c.find(".dk_toggle").css({width:i+"px"}),t.before(c),c=$("#dk_container_"+r).fadeIn(e.startSpeed),p=e.theme?e.theme:"default",c.addClass("dk_theme_"+p),o.theme=p,o.$dk=c,t.data("dropkick",o),c.data("dropkick",o),u[u.length]=t,c.bind("focus.dropkick",function(e){c.addClass("dk_focus")}).bind("blur.dropkick",function(e){c.removeClass("dk_open dk_focus")}),void setTimeout(function(){t.hide()},0))})},p.theme=function(e){var t=$(this),a=t.data("dropkick"),n=a.$dk,o="dk_theme_"+a.theme;n.removeClass(o).addClass("dk_theme_"+e),a.theme=e},p.reset=function(){for(var e=0,t=u.length;t>e;e++){var a=u[e].data("dropkick"),r=a.$dk,i=r.find("li").first();r.find(".dk_label").text(a.label),r.find(".dk_options_inner").animate({scrollTop:0},0),o(i,r),n(i,r,!0)}},$.fn.dropkick=function(e){if(!c){if(p[e])return p[e].apply(this,Array.prototype.slice.call(arguments,1));if("object"==typeof e||!e)return p.init.apply(this,arguments)}},$(function(){$(".dk_toggle").live("click",function(t){var a=$(this).parents(".dk_container").first();return s(a),"ontouchstart"in e&&(a.addClass("dk_touch"),a.find(".dk_options_inner").addClass("scrollable vertical")),t.preventDefault(),!1}),$(".dk_options a").live($.browser.msie?"mousedown":"click",function(e){var t=$(this),a=t.parents(".dk_container").first(),r=a.data("dropkick");return i(a),n(t,a),o(t.parent(),a),e.preventDefault(),!1}),$(t).bind("keydown.dk_nav",function(e){var t=$(".dk_container.dk_open"),n=$(".dk_container.dk_focus"),o=null;t.length?o=t:n.length&&!t.length&&(o=n),o&&a(e,o)})})}(jQuery,window,document);